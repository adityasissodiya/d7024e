<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: KademliaArchitecture Pages: 1 -->
<svg width="1787pt" height="930pt"
 viewBox="0.00 0.00 1787.00 929.58" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 925.58)">
<title>KademliaArchitecture</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-925.58 1783,-925.58 1783,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_utils</title>
<path fill="none" stroke="black" d="M618,-680.58C618,-680.58 908.75,-680.58 908.75,-680.58 914.75,-680.58 920.75,-686.58 920.75,-692.58 920.75,-692.58 920.75,-861.58 920.75,-861.58 920.75,-867.58 914.75,-873.58 908.75,-873.58 908.75,-873.58 618,-873.58 618,-873.58 612,-873.58 606,-867.58 606,-861.58 606,-861.58 606,-692.58 606,-692.58 606,-686.58 612,-680.58 618,-680.58"/>
<text text-anchor="middle" x="690.5" y="-860.08" font-family="Times New Roman,serif" font-size="10.00">Contact &amp; KademliaID Utilities (M1)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_routing</title>
<path fill="none" stroke="black" d="M1180.75,-583.58C1180.75,-583.58 1446,-583.58 1446,-583.58 1452,-583.58 1458,-589.58 1458,-595.58 1458,-595.58 1458,-752.58 1458,-752.58 1458,-758.58 1452,-764.58 1446,-764.58 1446,-764.58 1180.75,-764.58 1180.75,-764.58 1174.75,-764.58 1168.75,-758.58 1168.75,-752.58 1168.75,-752.58 1168.75,-595.58 1168.75,-595.58 1168.75,-589.58 1174.75,-583.58 1180.75,-583.58"/>
<text text-anchor="middle" x="1239.75" y="-751.08" font-family="Times New Roman,serif" font-size="10.00">Routing Table &amp; Buckets (M1)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_core</title>
<path fill="none" stroke="black" d="M20,-483.58C20,-483.58 852.5,-483.58 852.5,-483.58 858.5,-483.58 864.5,-489.58 864.5,-495.58 864.5,-495.58 864.5,-660.58 864.5,-660.58 864.5,-666.58 858.5,-672.58 852.5,-672.58 852.5,-672.58 20,-672.58 20,-672.58 14,-672.58 8,-666.58 8,-660.58 8,-660.58 8,-495.58 8,-495.58 8,-489.58 14,-483.58 20,-483.58"/>
<text text-anchor="middle" x="70.38" y="-659.08" font-family="Times New Roman,serif" font-size="10.00">Kademlia Core (M1 + M2)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_network</title>
<path fill="none" stroke="black" d="M692.25,-263.58C692.25,-263.58 1406.25,-263.58 1406.25,-263.58 1412.25,-263.58 1418.25,-269.58 1418.25,-275.58 1418.25,-275.58 1418.25,-463.58 1418.25,-463.58 1418.25,-469.58 1412.25,-475.58 1406.25,-475.58 1406.25,-475.58 692.25,-475.58 692.25,-475.58 686.25,-475.58 680.25,-469.58 680.25,-463.58 680.25,-463.58 680.25,-275.58 680.25,-275.58 680.25,-269.58 686.25,-263.58 692.25,-263.58"/>
<text text-anchor="middle" x="772.62" y="-462.08" font-family="Times New Roman,serif" font-size="10.00">Network Layer (UDP) &amp; Wire (M1 + M2)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_remoteB</title>
<path fill="none" stroke="black" d="M1233.25,-55.58C1233.25,-55.58 1759,-55.58 1759,-55.58 1765,-55.58 1771,-61.58 1771,-67.58 1771,-67.58 1771,-233.58 1771,-233.58 1771,-239.58 1765,-245.58 1759,-245.58 1759,-245.58 1233.25,-245.58 1233.25,-245.58 1227.25,-245.58 1221.25,-239.58 1221.25,-233.58 1221.25,-233.58 1221.25,-67.58 1221.25,-67.58 1221.25,-61.58 1227.25,-55.58 1233.25,-55.58"/>
<text text-anchor="middle" x="1291.12" y="-232.08" font-family="Times New Roman,serif" font-size="10.00">Remote Peer B (Handlers side)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_remoteC</title>
<path fill="none" stroke="black" d="M1256,-483.58C1256,-483.58 1371.75,-483.58 1371.75,-483.58 1377.75,-483.58 1383.75,-489.58 1383.75,-495.58 1383.75,-495.58 1383.75,-548.58 1383.75,-548.58 1383.75,-554.58 1377.75,-560.58 1371.75,-560.58 1371.75,-560.58 1256,-560.58 1256,-560.58 1250,-560.58 1244,-554.58 1244,-548.58 1244,-548.58 1244,-495.58 1244,-495.58 1244,-489.58 1250,-483.58 1256,-483.58"/>
<text text-anchor="middle" x="1313.88" y="-547.08" font-family="Times New Roman,serif" font-size="10.00">Remote Peer C (Handlers side)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_legend</title>
<path fill="none" stroke="black" d="M51.5,-680.58C51.5,-680.58 262.75,-680.58 262.75,-680.58 268.75,-680.58 274.75,-686.58 274.75,-692.58 274.75,-692.58 274.75,-901.58 274.75,-901.58 274.75,-907.58 268.75,-913.58 262.75,-913.58 262.75,-913.58 51.5,-913.58 51.5,-913.58 45.5,-913.58 39.5,-907.58 39.5,-901.58 39.5,-901.58 39.5,-692.58 39.5,-692.58 39.5,-686.58 45.5,-680.58 51.5,-680.58"/>
<text text-anchor="middle" x="62.88" y="-900.08" font-family="Times New Roman,serif" font-size="10.00">Legend</text>
</g>
<!-- ContactUtils -->
<g id="node1" class="node">
<title>ContactUtils</title>
<polygon fill="none" stroke="black" points="912.75,-846.33 614,-846.33 614,-770.83 912.75,-770.83 912.75,-846.33"/>
<text text-anchor="middle" x="763.38" y="-832.83" font-family="Times New Roman,serif" font-size="10.00">contact.go</text>
<text text-anchor="middle" x="763.38" y="-821.58" font-family="Times New Roman,serif" font-size="10.00">&#45; NewContact</text>
<text text-anchor="middle" x="763.38" y="-810.33" font-family="Times New Roman,serif" font-size="10.00">&#45; Contact.CalcDistance (XOR to target)</text>
<text text-anchor="middle" x="763.38" y="-799.08" font-family="Times New Roman,serif" font-size="10.00">&#45; Contact.Less (by last distance)</text>
<text text-anchor="middle" x="763.38" y="-787.83" font-family="Times New Roman,serif" font-size="10.00">&#45; Contact.String</text>
<text text-anchor="middle" x="763.38" y="-776.58" font-family="Times New Roman,serif" font-size="10.00">&#45; ContactCandidates: Append / GetContacts / Sort / Len / Swap / Less</text>
</g>
<!-- RoutingTable -->
<g id="node4" class="node">
<title>RoutingTable</title>
<polygon fill="none" stroke="black" points="1417.75,-737.7 1209,-737.7 1209,-673.45 1417.75,-673.45 1417.75,-737.7"/>
<text text-anchor="middle" x="1313.38" y="-724.2" font-family="Times New Roman,serif" font-size="10.00">routingtable.go</text>
<text text-anchor="middle" x="1313.38" y="-712.95" font-family="Times New Roman,serif" font-size="10.00">&#45; NewRoutingTable (IDLength*8 buckets)</text>
<text text-anchor="middle" x="1313.38" y="-701.7" font-family="Times New Roman,serif" font-size="10.00">&#45; RoutingTable.AddContact</text>
<text text-anchor="middle" x="1313.38" y="-690.45" font-family="Times New Roman,serif" font-size="10.00">&#45; RoutingTable.FindClosestContacts</text>
<text text-anchor="middle" x="1313.38" y="-679.2" font-family="Times New Roman,serif" font-size="10.00">&#45; RoutingTable.getBucketIndex (MSB of XOR)</text>
</g>
<!-- ContactUtils&#45;&gt;RoutingTable -->
<g id="edge25" class="edge">
<title>ContactUtils&#45;&gt;RoutingTable</title>
<path fill="none" stroke="black" d="M912.91,-782.13C986.86,-768.79 1077.59,-752.17 1158.75,-736.58 1171.38,-734.15 1184.58,-731.56 1197.72,-728.96"/>
<polygon fill="black" stroke="black" points="1198.11,-732.45 1207.23,-727.06 1196.74,-725.58 1198.11,-732.45"/>
<text text-anchor="middle" x="1044.75" y="-781.46" font-family="Times New Roman,serif" font-size="14.00">distance calc &amp; sorting helpers</text>
</g>
<!-- KademliaIDUtils -->
<g id="node2" class="node">
<title>KademliaIDUtils</title>
<polygon fill="none" stroke="black" points="864.75,-752.7 662,-752.7 662,-688.45 864.75,-688.45 864.75,-752.7"/>
<text text-anchor="middle" x="763.38" y="-739.2" font-family="Times New Roman,serif" font-size="10.00">kademliaid.go</text>
<text text-anchor="middle" x="763.38" y="-727.95" font-family="Times New Roman,serif" font-size="10.00">&#45; NewKademliaID / NewRandomKademliaID</text>
<text text-anchor="middle" x="763.38" y="-716.7" font-family="Times New Roman,serif" font-size="10.00">&#45; KademliaID.Less / Equals</text>
<text text-anchor="middle" x="763.38" y="-705.45" font-family="Times New Roman,serif" font-size="10.00">&#45; KademliaID.CalcDistance (XOR)</text>
<text text-anchor="middle" x="763.38" y="-694.2" font-family="Times New Roman,serif" font-size="10.00">&#45; KademliaID.String</text>
</g>
<!-- KademliaIDUtils&#45;&gt;RoutingTable -->
<g id="edge26" class="edge">
<title>KademliaIDUtils&#45;&gt;RoutingTable</title>
<path fill="none" stroke="black" d="M865.21,-717.82C959.17,-715.25 1099.17,-711.41 1197.43,-708.72"/>
<polygon fill="black" stroke="black" points="1197.49,-712.22 1207.39,-708.45 1197.3,-705.23 1197.49,-712.22"/>
<text text-anchor="middle" x="1044.75" y="-718.93" font-family="Times New Roman,serif" font-size="14.00">XOR distance; MSB index</text>
</g>
<!-- Bucket -->
<g id="node3" class="node">
<title>Bucket</title>
<polygon fill="none" stroke="black" points="1450,-655.7 1176.75,-655.7 1176.75,-591.45 1450,-591.45 1450,-655.7"/>
<text text-anchor="middle" x="1313.38" y="-642.2" font-family="Times New Roman,serif" font-size="10.00">bucket.go</text>
<text text-anchor="middle" x="1313.38" y="-630.95" font-family="Times New Roman,serif" font-size="10.00">&#45; newBucket</text>
<text text-anchor="middle" x="1313.38" y="-619.7" font-family="Times New Roman,serif" font-size="10.00">&#45; bucket.AddContact (move&#45;to&#45;front; LRU&#45;ish; bucketSize=20)</text>
<text text-anchor="middle" x="1313.38" y="-608.45" font-family="Times New Roman,serif" font-size="10.00">&#45; bucket.GetContactAndCalcDistance</text>
<text text-anchor="middle" x="1313.38" y="-597.2" font-family="Times New Roman,serif" font-size="10.00">&#45; bucket.Len / Swap / Less</text>
</g>
<!-- KademliaCore -->
<g id="node5" class="node">
<title>KademliaCore</title>
<polygon fill="none" stroke="black" points="298.25,-645.7 16,-645.7 16,-491.45 298.25,-491.45 298.25,-645.7"/>
<text text-anchor="middle" x="157.12" y="-632.2" font-family="Times New Roman,serif" font-size="10.00">kademlia.go</text>
<text text-anchor="middle" x="157.12" y="-620.95" font-family="Times New Roman,serif" font-size="10.00">&#45; NewKademlia (α=3, RPC timeout=800ms)</text>
<text text-anchor="middle" x="157.12" y="-609.7" font-family="Times New Roman,serif" font-size="10.00">&#45; Kademlia.Close</text>
<text text-anchor="middle" x="157.12" y="-598.45" font-family="Times New Roman,serif" font-size="10.00">&#45; Kademlia.Join (Ping + self LookupContact)</text>
<text text-anchor="middle" x="157.12" y="-587.2" font-family="Times New Roman,serif" font-size="10.00">&#45; Kademlia.LookupContact (iterative FIND_NODE, α&#45;parallel)</text>
<text text-anchor="middle" x="157.12" y="-575.95" font-family="Times New Roman,serif" font-size="10.00">&#45; Kademlia.ClosestContacts</text>
<text text-anchor="middle" x="157.12" y="-564.7" font-family="Times New Roman,serif" font-size="10.00">M2:</text>
<text text-anchor="middle" x="157.12" y="-553.45" font-family="Times New Roman,serif" font-size="10.00">&#45; keyFromData (SHA&#45;1)</text>
<text text-anchor="middle" x="157.12" y="-542.2" font-family="Times New Roman,serif" font-size="10.00">&#45; storeLocal / loadLocal (thread&#45;safe)</text>
<text text-anchor="middle" x="157.12" y="-530.95" font-family="Times New Roman,serif" font-size="10.00">&#45; Kademlia.Store (delegate to Put)</text>
<text text-anchor="middle" x="157.12" y="-519.7" font-family="Times New Roman,serif" font-size="10.00">&#45; Kademlia.Put (replicate to K closest via STORE)</text>
<text text-anchor="middle" x="157.12" y="-508.45" font-family="Times New Roman,serif" font-size="10.00">&#45; Kademlia.LookupData (delegate to Get)</text>
<text text-anchor="middle" x="157.12" y="-497.2" font-family="Times New Roman,serif" font-size="10.00">&#45; Kademlia.Get (iterative FIND_VALUE, α&#45;parallel; cache on hit)</text>
</g>
<!-- KademliaCore&#45;&gt;RoutingTable -->
<g id="edge1" class="edge">
<title>KademliaCore&#45;&gt;RoutingTable</title>
<path fill="none" stroke="black" d="M298.68,-561.99C485.58,-554.32 805.71,-545.28 920.75,-567.08 949.84,-572.59 1140.7,-655.09 1168.75,-664.58 1178.22,-667.78 1188.1,-670.95 1198.04,-674.02"/>
<polygon fill="black" stroke="black" points="1196.81,-677.31 1207.39,-676.88 1198.85,-670.61 1196.81,-677.31"/>
<text text-anchor="middle" x="763.38" y="-570.28" font-family="Times New Roman,serif" font-size="14.00">FindClosestContacts / AddContact</text>
</g>
<!-- LocalStore -->
<g id="node6" class="node">
<title>LocalStore</title>
<polygon fill="none" stroke="black" points="856.5,-645.08 670.25,-645.08 670.25,-592.08 856.5,-592.08 856.5,-645.08"/>
<text text-anchor="middle" x="763.38" y="-631.58" font-family="Times New Roman,serif" font-size="10.00">Local Value Store (M2)</text>
<text text-anchor="middle" x="763.38" y="-620.33" font-family="Times New Roman,serif" font-size="10.00">&#45; valueStore: map[keyHex][]byte</text>
<text text-anchor="middle" x="763.38" y="-609.08" font-family="Times New Roman,serif" font-size="10.00">&#45; RWMutex: concurrent reads / safe writes</text>
<text text-anchor="middle" x="763.38" y="-597.83" font-family="Times New Roman,serif" font-size="10.00">&#45; storeLocal / loadLocal</text>
</g>
<!-- KademliaCore&#45;&gt;LocalStore -->
<g id="edge2" class="edge">
<title>KademliaCore&#45;&gt;LocalStore</title>
<path fill="none" stroke="black" d="M298.65,-580.21C408.78,-589.32 559.49,-601.79 658.81,-610.01"/>
<polygon fill="black" stroke="black" points="658.3,-613.48 668.55,-610.81 658.88,-606.5 658.3,-613.48"/>
<text text-anchor="middle" x="456.12" y="-607" font-family="Times New Roman,serif" font-size="14.00">storeLocal / loadLocal</text>
</g>
<!-- Network -->
<g id="node7" class="node">
<title>Network</title>
<polygon fill="none" stroke="black" points="838.5,-447.95 688.25,-447.95 688.25,-271.2 838.5,-271.2 838.5,-447.95"/>
<text text-anchor="middle" x="763.38" y="-434.45" font-family="Times New Roman,serif" font-size="10.00">network.go</text>
<text text-anchor="middle" x="763.38" y="-423.2" font-family="Times New Roman,serif" font-size="10.00">&#45; NewNetwork / Close</text>
<text text-anchor="middle" x="763.38" y="-411.95" font-family="Times New Roman,serif" font-size="10.00">&#45; nextMsgID (16B hex)</text>
<text text-anchor="middle" x="763.38" y="-400.7" font-family="Times New Roman,serif" font-size="10.00">&#45; send (JSON over UDP)</text>
<text text-anchor="middle" x="763.38" y="-389.45" font-family="Times New Roman,serif" font-size="10.00">&#45; readLoop (goroutine)</text>
<text text-anchor="middle" x="763.38" y="-378.2" font-family="Times New Roman,serif" font-size="10.00">Handlers:</text>
<text text-anchor="middle" x="763.38" y="-366.95" font-family="Times New Roman,serif" font-size="10.00"> &#160;&#45; handlePing</text>
<text text-anchor="middle" x="763.38" y="-355.7" font-family="Times New Roman,serif" font-size="10.00"> &#160;&#45; handleFindNode</text>
<text text-anchor="middle" x="763.38" y="-344.45" font-family="Times New Roman,serif" font-size="10.00"> &#160;&#45; handleFindValue (M2)</text>
<text text-anchor="middle" x="763.38" y="-333.2" font-family="Times New Roman,serif" font-size="10.00"> &#160;&#45; handleStore (M2)</text>
<text text-anchor="middle" x="763.38" y="-321.95" font-family="Times New Roman,serif" font-size="10.00">Client RPCs:</text>
<text text-anchor="middle" x="763.38" y="-310.7" font-family="Times New Roman,serif" font-size="10.00"> &#160;&#45; SendPingMessage</text>
<text text-anchor="middle" x="763.38" y="-299.45" font-family="Times New Roman,serif" font-size="10.00"> &#160;&#45; SendFindContactMessage / To</text>
<text text-anchor="middle" x="763.38" y="-288.2" font-family="Times New Roman,serif" font-size="10.00"> &#160;&#45; sendFindValueTo (M2)</text>
<text text-anchor="middle" x="763.38" y="-276.95" font-family="Times New Roman,serif" font-size="10.00"> &#160;&#45; sendStoreTo (M2)</text>
</g>
<!-- KademliaCore&#45;&gt;Network -->
<g id="edge21" class="edge">
<title>KademliaCore&#45;&gt;Network</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M296.61,-491.11C303.17,-488.54 309.73,-486.18 316.25,-484.08 435.64,-445.57 476.44,-484.55 596,-446.58 623.7,-437.78 652.29,-424.56 677.78,-411.06"/>
<polygon fill="black" stroke="black" points="679.29,-414.22 686.43,-406.4 675.97,-408.06 679.29,-414.22"/>
<text text-anchor="middle" x="456.12" y="-487.28" font-family="Times New Roman,serif" font-size="14.00">SendPingMessage (wait ≤800ms)</text>
</g>
<!-- KademliaCore&#45;&gt;Network -->
<g id="edge22" class="edge">
<title>KademliaCore&#45;&gt;Network</title>
<path fill="none" stroke="black" stroke-width="2" d="M226.26,-491.14C252.02,-466.53 283.16,-441.69 316.25,-426.08 320.3,-424.17 546.9,-390.95 675.54,-372.2"/>
<polygon fill="black" stroke="black" stroke-width="2" points="675.67,-375.72 685.06,-370.82 674.66,-368.8 675.67,-375.72"/>
<text text-anchor="middle" x="456.12" y="-429.28" font-family="Times New Roman,serif" font-size="14.00">SendFindContactMessageTo (α=3 parallel batches)</text>
</g>
<!-- KademliaCore&#45;&gt;Network -->
<g id="edge23" class="edge">
<title>KademliaCore&#45;&gt;Network</title>
<path fill="none" stroke="black" stroke-width="2" d="M195.39,-490.98C222.06,-445.01 262.7,-390.7 316.25,-364.08 430.14,-307.46 581.47,-321.62 675.36,-339.06"/>
<polygon fill="black" stroke="black" stroke-width="2" points="674.47,-342.45 684.96,-340.91 675.8,-335.58 674.47,-342.45"/>
<text text-anchor="middle" x="456.12" y="-367.28" font-family="Times New Roman,serif" font-size="14.00">sendFindValueTo (α=3 parallel batches)</text>
</g>
<!-- KademliaCore&#45;&gt;Network -->
<g id="edge24" class="edge">
<title>KademliaCore&#45;&gt;Network</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M298.4,-530.5C304.41,-529.27 310.38,-528.12 316.25,-527.08 377.74,-516.17 544.83,-536.37 596,-500.58 604.47,-494.65 599.5,-487.61 606,-479.58 626.51,-454.24 653.41,-431.14 679.1,-412.12"/>
<polygon fill="black" stroke="black" points="680.87,-415.16 686.9,-406.46 676.76,-409.5 680.87,-415.16"/>
<text text-anchor="middle" x="456.12" y="-530.28" font-family="Times New Roman,serif" font-size="14.00">sendStoreTo (replicate to K closest; ACK)</text>
</g>
<!-- Network&#45;&gt;RoutingTable -->
<g id="edge5" class="edge">
<title>Network&#45;&gt;RoutingTable</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M838.67,-400.46C868.54,-420.53 900.61,-447.37 920.75,-479.58 932.53,-498.42 914.31,-513.62 930.75,-528.58 968.44,-562.87 1123.04,-516.73 1158.75,-553.08 1176.19,-570.82 1152.89,-645.41 1168.75,-664.58 1176.87,-674.39 1187.16,-681.95 1198.48,-687.75"/>
<polygon fill="black" stroke="black" points="1196.75,-690.81 1207.3,-691.79 1199.67,-684.44 1196.75,-690.81"/>
<text text-anchor="middle" x="1044.75" y="-556.28" font-family="Times New Roman,serif" font-size="14.00">AddContact on ping/response (learn peer)</text>
</g>
<!-- Inflight -->
<g id="node8" class="node">
<title>Inflight</title>
<polygon fill="none" stroke="black" points="1385.12,-332.45 1241.62,-332.45 1241.62,-290.7 1385.12,-290.7 1385.12,-332.45"/>
<text text-anchor="middle" x="1313.38" y="-318.95" font-family="Times New Roman,serif" font-size="10.00">Inflight Map &amp; Channels</text>
<text text-anchor="middle" x="1313.38" y="-307.7" font-family="Times New Roman,serif" font-size="10.00">&#45; map[MsgID] &#45;&gt; chan response</text>
<text text-anchor="middle" x="1313.38" y="-296.45" font-family="Times New Roman,serif" font-size="10.00">&#45; wait ≤ 800ms per RPC</text>
</g>
<!-- Network&#45;&gt;Inflight -->
<g id="edge3" class="edge">
<title>Network&#45;&gt;Inflight</title>
<path fill="none" stroke="black" d="M838.96,-354.81C918.32,-349.53 1047.51,-340.32 1158.75,-329.58 1181.95,-327.34 1207.08,-324.55 1230.16,-321.84"/>
<polygon fill="black" stroke="black" points="1230.29,-325.35 1239.81,-320.69 1229.46,-318.4 1230.29,-325.35"/>
<text text-anchor="middle" x="1044.75" y="-351.37" font-family="Times New Roman,serif" font-size="14.00">register chan by MsgID</text>
</g>
<!-- Wire -->
<g id="node9" class="node">
<title>Wire</title>
<polygon fill="none" stroke="black" points="1410.25,-448.58 1216.5,-448.58 1216.5,-350.58 1410.25,-350.58 1410.25,-448.58"/>
<text text-anchor="middle" x="1313.38" y="-435.08" font-family="Times New Roman,serif" font-size="10.00">wire.go</text>
<text text-anchor="middle" x="1313.38" y="-423.83" font-family="Times New Roman,serif" font-size="10.00">&#45; envelope.marshal / unmarshal (JSON)</text>
<text text-anchor="middle" x="1313.38" y="-412.58" font-family="Times New Roman,serif" font-size="10.00">&#45; fromContact / wireContact.toContact</text>
<text text-anchor="middle" x="1313.38" y="-401.33" font-family="Times New Roman,serif" font-size="10.00">Message Types:</text>
<text text-anchor="middle" x="1313.38" y="-390.08" font-family="Times New Roman,serif" font-size="10.00"> &#160;PING / PONG</text>
<text text-anchor="middle" x="1313.38" y="-378.83" font-family="Times New Roman,serif" font-size="10.00"> &#160;FIND_NODE / FIND_NODE_OK</text>
<text text-anchor="middle" x="1313.38" y="-367.58" font-family="Times New Roman,serif" font-size="10.00"> &#160;FIND_VALUE / FIND_VALUE_OK (M2)</text>
<text text-anchor="middle" x="1313.38" y="-356.33" font-family="Times New Roman,serif" font-size="10.00"> &#160;STORE / STORE_OK (M2)</text>
</g>
<!-- Network&#45;&gt;Wire -->
<g id="edge6" class="edge">
<title>Network&#45;&gt;Wire</title>
<path fill="none" stroke="black" d="M838.69,-386.97C867.08,-396.08 900.01,-405.06 930.75,-409.58 1022.62,-423.08 1128.24,-418.81 1205.04,-412.17"/>
<polygon fill="black" stroke="black" points="1205,-415.69 1214.65,-411.31 1204.38,-408.72 1205,-415.69"/>
<text text-anchor="middle" x="1044.75" y="-421.64" font-family="Times New Roman,serif" font-size="14.00">marshal/unmarshal JSON</text>
</g>
<!-- RemoteNetworkB -->
<g id="node10" class="node">
<title>RemoteNetworkB</title>
<polygon fill="none" stroke="black" points="1397.5,-194.33 1229.25,-194.33 1229.25,-118.83 1397.5,-118.83 1397.5,-194.33"/>
<text text-anchor="middle" x="1313.38" y="-180.83" font-family="Times New Roman,serif" font-size="10.00">Network Handlers (on B)</text>
<text text-anchor="middle" x="1313.38" y="-169.58" font-family="Times New Roman,serif" font-size="10.00">&#45; readLoop (goroutine)</text>
<text text-anchor="middle" x="1313.38" y="-158.33" font-family="Times New Roman,serif" font-size="10.00">&#45; handlePing → PONG</text>
<text text-anchor="middle" x="1313.38" y="-147.08" font-family="Times New Roman,serif" font-size="10.00">&#45; handleFindNode → contacts</text>
<text text-anchor="middle" x="1313.38" y="-135.83" font-family="Times New Roman,serif" font-size="10.00">&#45; handleFindValue → value | contacts</text>
<text text-anchor="middle" x="1313.38" y="-124.58" font-family="Times New Roman,serif" font-size="10.00">&#45; handleStore → STORE_OK</text>
</g>
<!-- Network&#45;&gt;RemoteNetworkB -->
<g id="edge7" class="edge">
<title>Network&#45;&gt;RemoteNetworkB</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M782.47,-270.9C803.55,-193.07 846.81,-84.52 930.75,-33.08 1017.15,19.87 1063.17,0.58 1158.75,-33.08 1202.38,-48.44 1242.76,-82.01 1271.16,-110.27"/>
<polygon fill="black" stroke="black" points="1268.65,-112.71 1278.15,-117.38 1273.64,-107.8 1268.65,-112.71"/>
<text text-anchor="middle" x="1044.75" y="-36.28" font-family="Times New Roman,serif" font-size="14.00">PING</text>
</g>
<!-- Network&#45;&gt;RemoteNetworkB -->
<g id="edge9" class="edge">
<title>Network&#45;&gt;RemoteNetworkB</title>
<path fill="none" stroke="black" stroke-width="2" stroke-dasharray="5,2" d="M838.91,-333.32C867.32,-324.27 900.22,-314.95 930.75,-309.08 980.69,-299.47 1118.8,-321.04 1158.75,-289.58 1169.79,-280.88 1160.41,-270.89 1168.75,-259.58 1185.25,-237.19 1208.08,-217.74 1230.67,-201.96"/>
<polygon fill="black" stroke="black" stroke-width="2" points="1232.53,-204.93 1238.86,-196.43 1228.61,-199.13 1232.53,-204.93"/>
<text text-anchor="middle" x="1044.75" y="-312.28" font-family="Times New Roman,serif" font-size="14.00">FIND_NODE</text>
</g>
<!-- Network&#45;&gt;RemoteNetworkB -->
<g id="edge12" class="edge">
<title>Network&#45;&gt;RemoteNetworkB</title>
<path fill="none" stroke="black" stroke-width="2" stroke-dasharray="5,2" d="M838.93,-310.49C866.66,-294.57 899.1,-278.58 930.75,-269.08 1028.16,-239.82 1062.05,-281.07 1158.75,-249.58 1191.73,-238.84 1225.05,-219.87 1252.19,-201.86"/>
<polygon fill="black" stroke="black" stroke-width="2" points="1253.84,-204.97 1260.15,-196.46 1249.91,-199.18 1253.84,-204.97"/>
<text text-anchor="middle" x="1044.75" y="-272.28" font-family="Times New Roman,serif" font-size="14.00">FIND_VALUE</text>
</g>
<!-- Network&#45;&gt;RemoteNetworkB -->
<g id="edge15" class="edge">
<title>Network&#45;&gt;RemoteNetworkB</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M838.85,-286.19C865.71,-264.02 897.62,-242.13 930.75,-229.08 1025.38,-191.81 1059.25,-230.66 1158.75,-209.58 1178.31,-205.43 1198.82,-199.52 1218.25,-193.14"/>
<polygon fill="black" stroke="black" points="1219.12,-196.54 1227.48,-190.03 1216.89,-189.9 1219.12,-196.54"/>
<text text-anchor="middle" x="1044.75" y="-232.28" font-family="Times New Roman,serif" font-size="14.00">STORE (replica)</text>
</g>
<!-- RemoteNetworkC -->
<g id="node13" class="node">
<title>RemoteNetworkC</title>
<polygon fill="none" stroke="black" points="1372.75,-533.45 1254,-533.45 1254,-491.7 1372.75,-491.7 1372.75,-533.45"/>
<text text-anchor="middle" x="1313.38" y="-519.95" font-family="Times New Roman,serif" font-size="10.00">Network Handlers (on C)</text>
<text text-anchor="middle" x="1313.38" y="-508.7" font-family="Times New Roman,serif" font-size="10.00">&#45; readLoop</text>
<text text-anchor="middle" x="1313.38" y="-497.45" font-family="Times New Roman,serif" font-size="10.00">&#45; handle*</text>
</g>
<!-- Network&#45;&gt;RemoteNetworkC -->
<g id="edge11" class="edge">
<title>Network&#45;&gt;RemoteNetworkC</title>
<path fill="none" stroke="black" stroke-width="2" stroke-dasharray="5,2" d="M838.75,-413.52C865.24,-433.54 894.89,-456.9 920.75,-479.58 925.48,-483.72 925.02,-487 930.75,-489.58 958.18,-501.92 1138.06,-508.31 1240.78,-511"/>
<polygon fill="black" stroke="black" stroke-width="2" points="1240.4,-514.49 1250.49,-511.24 1240.58,-507.49 1240.4,-514.49"/>
<text text-anchor="middle" x="1044.75" y="-511.63" font-family="Times New Roman,serif" font-size="14.00">FIND_NODE (parallel α)</text>
</g>
<!-- Network&#45;&gt;RemoteNetworkC -->
<g id="edge14" class="edge">
<title>Network&#45;&gt;RemoteNetworkC</title>
<path fill="none" stroke="black" stroke-width="2" stroke-dasharray="5,2" d="M838.61,-400.89C866.72,-414.89 899.48,-429.31 930.75,-438.58 1028.77,-467.63 1067.66,-422.65 1158.75,-469.08 1164.49,-472 1163.15,-476.39 1168.75,-479.58 1190.61,-492.03 1216.86,-499.79 1240.92,-504.61"/>
<polygon fill="black" stroke="black" stroke-width="2" points="1240.19,-508.04 1250.65,-506.4 1241.45,-501.15 1240.19,-508.04"/>
<text text-anchor="middle" x="1044.75" y="-472.28" font-family="Times New Roman,serif" font-size="14.00">FIND_VALUE (parallel α)</text>
</g>
<!-- Inflight&#45;&gt;Network -->
<g id="edge4" class="edge">
<title>Inflight&#45;&gt;Network</title>
<path fill="none" stroke="black" d="M1241.46,-312.52C1216.03,-316.18 1188.73,-324.37 1168.75,-341.58 1159.05,-349.93 1169.25,-361.27 1158.75,-368.58 1117.16,-397.52 981.4,-369.95 930.75,-368.58 904.55,-367.87 876.06,-366.54 850.18,-365.11"/>
<polygon fill="black" stroke="black" points="850.57,-361.62 840.39,-364.55 850.18,-368.61 850.57,-361.62"/>
<text text-anchor="middle" x="1044.75" y="-384.95" font-family="Times New Roman,serif" font-size="14.00">deliver response to waiter</text>
</g>
<!-- RemoteNetworkB&#45;&gt;Network -->
<g id="edge8" class="edge">
<title>RemoteNetworkB&#45;&gt;Network</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1229.08,-163.84C1118.82,-173.55 937.44,-189.92 930.75,-193.08 896.27,-209.34 864.82,-235.86 838.78,-263"/>
<polygon fill="black" stroke="black" points="836.56,-260.26 832.26,-269.94 841.66,-265.05 836.56,-260.26"/>
<text text-anchor="middle" x="1044.75" y="-196.28" font-family="Times New Roman,serif" font-size="14.00">PONG</text>
</g>
<!-- RemoteNetworkB&#45;&gt;Network -->
<g id="edge10" class="edge">
<title>RemoteNetworkB&#45;&gt;Network</title>
<path fill="none" stroke="black" stroke-width="2" stroke-dasharray="5,2" d="M1228.86,-146.82C1132.69,-137.06 981.42,-126.68 930.75,-151.08 882.96,-174.08 844.63,-218.24 816.86,-260.01"/>
<polygon fill="black" stroke="black" stroke-width="2" points="813.99,-258.01 811.5,-268.31 819.87,-261.81 813.99,-258.01"/>
<text text-anchor="middle" x="1044.75" y="-154.28" font-family="Times New Roman,serif" font-size="14.00">FIND_NODE_OK (contacts)</text>
</g>
<!-- RemoteNetworkB&#45;&gt;Network -->
<g id="edge13" class="edge">
<title>RemoteNetworkB&#45;&gt;Network</title>
<path fill="none" stroke="black" stroke-width="2" stroke-dasharray="5,2" d="M1229.07,-129.79C1206.49,-123.71 1181.89,-118.15 1158.75,-115.08 1058.3,-101.75 1020.32,-67.69 930.75,-115.08 873.04,-145.61 831.61,-206.15 804.52,-259.34"/>
<polygon fill="black" stroke="black" stroke-width="2" points="801.44,-257.69 800.14,-268.2 807.71,-260.79 801.44,-257.69"/>
<text text-anchor="middle" x="1044.75" y="-118.28" font-family="Times New Roman,serif" font-size="14.00">FIND_VALUE_OK (value | contacts)</text>
</g>
<!-- RemoteNetworkB&#45;&gt;Network -->
<g id="edge16" class="edge">
<title>RemoteNetworkB&#45;&gt;Network</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1260.55,-118.53C1232.05,-99.97 1195.17,-79.63 1158.75,-70.08 1109.74,-57.23 974.6,-44.7 930.75,-70.08 860.5,-110.73 817.33,-193.51 792.63,-260.18"/>
<polygon fill="black" stroke="black" points="789.43,-258.71 789.33,-269.3 796.02,-261.09 789.43,-258.71"/>
<text text-anchor="middle" x="1044.75" y="-73.28" font-family="Times New Roman,serif" font-size="14.00">STORE_OK</text>
</g>
<!-- RemoteRoutingB -->
<g id="node11" class="node">
<title>RemoteRoutingB</title>
<polygon fill="none" stroke="black" points="1755.12,-125.58 1667.88,-125.58 1667.88,-89.58 1755.12,-89.58 1755.12,-125.58"/>
<text text-anchor="middle" x="1711.5" y="-103.7" font-family="Times New Roman,serif" font-size="10.00">RoutingTable (B)</text>
</g>
<!-- RemoteNetworkB&#45;&gt;RemoteRoutingB -->
<g id="edge17" class="edge">
<title>RemoteNetworkB&#45;&gt;RemoteRoutingB</title>
<path fill="none" stroke="black" d="M1377.82,-118.37C1404.65,-104.33 1436.86,-90.14 1468,-83.08 1543.42,-65.97 1565.8,-69.86 1642,-83.08 1646.89,-83.93 1651.9,-85.09 1656.87,-86.46"/>
<polygon fill="black" stroke="black" points="1655.59,-89.73 1666.17,-89.28 1657.62,-83.03 1655.59,-89.73"/>
<text text-anchor="middle" x="1555" y="-86.28" font-family="Times New Roman,serif" font-size="14.00">AddContact (learn sender)</text>
</g>
<!-- RemoteNetworkB&#45;&gt;RemoteRoutingB -->
<g id="edge18" class="edge">
<title>RemoteNetworkB&#45;&gt;RemoteRoutingB</title>
<path fill="none" stroke="black" d="M1397.62,-143.82C1420.41,-140.48 1445.14,-137 1468,-134.08 1532.56,-125.83 1607,-117.93 1656.19,-112.94"/>
<polygon fill="black" stroke="black" points="1656.41,-116.43 1666.01,-111.95 1655.71,-109.47 1656.41,-116.43"/>
<text text-anchor="middle" x="1555" y="-137.28" font-family="Times New Roman,serif" font-size="14.00">FindClosest (for *Node/*Value)</text>
</g>
<!-- RemoteStoreB -->
<g id="node12" class="node">
<title>RemoteStoreB</title>
<polygon fill="none" stroke="black" points="1763,-192.58 1660,-192.58 1660,-156.58 1763,-156.58 1763,-192.58"/>
<text text-anchor="middle" x="1711.5" y="-170.7" font-family="Times New Roman,serif" font-size="10.00">Local Value Store (B)</text>
</g>
<!-- RemoteNetworkB&#45;&gt;RemoteStoreB -->
<g id="edge19" class="edge">
<title>RemoteNetworkB&#45;&gt;RemoteStoreB</title>
<path fill="none" stroke="black" d="M1397.71,-154.87C1464.04,-154.33 1559.16,-155.34 1642,-163.08 1644.16,-163.28 1646.36,-163.51 1648.57,-163.76"/>
<polygon fill="black" stroke="black" points="1647.87,-167.2 1658.23,-165.01 1648.76,-160.26 1647.87,-167.2"/>
<text text-anchor="middle" x="1555" y="-166.28" font-family="Times New Roman,serif" font-size="14.00">loadLocal (FIND_VALUE)</text>
</g>
<!-- RemoteNetworkB&#45;&gt;RemoteStoreB -->
<g id="edge20" class="edge">
<title>RemoteNetworkB&#45;&gt;RemoteStoreB</title>
<path fill="none" stroke="black" d="M1397.84,-171.38C1420.52,-174.77 1445.14,-177.88 1468,-179.58 1545.12,-185.32 1564.72,-182.39 1642,-179.58 1644.06,-179.5 1646.15,-179.42 1648.25,-179.32"/>
<polygon fill="black" stroke="black" points="1648.34,-182.82 1658.14,-178.79 1647.96,-175.83 1648.34,-182.82"/>
<text text-anchor="middle" x="1555" y="-186.08" font-family="Times New Roman,serif" font-size="14.00">storeLocal (STORE)</text>
</g>
<!-- Legend1 -->
<g id="node14" class="node">
<title>Legend1</title>
<polygon fill="none" stroke="black" points="245,-724.58 69.25,-724.58 69.25,-688.58 245,-688.58 245,-724.58"/>
<text text-anchor="middle" x="157.12" y="-702.7" font-family="Times New Roman,serif" font-size="10.00">Solid edge: in&#45;process call / data access</text>
</g>
<!-- Legend2 -->
<g id="node15" class="node">
<title>Legend2</title>
<polygon fill="none" stroke="black" points="265.25,-778.58 49,-778.58 49,-742.58 265.25,-742.58 265.25,-778.58"/>
<text text-anchor="middle" x="157.12" y="-756.7" font-family="Times New Roman,serif" font-size="10.00">Dashed edge: async UDP RPC (request/response)</text>
</g>
<!-- Legend3 -->
<g id="node16" class="node">
<title>Legend3</title>
<polygon fill="none" stroke="black" points="261.5,-832.58 52.75,-832.58 52.75,-796.58 261.5,-796.58 261.5,-832.58"/>
<text text-anchor="middle" x="157.12" y="-810.7" font-family="Times New Roman,serif" font-size="10.00">Bold edge: α&#45;parallel fan&#45;out in a lookup round</text>
</g>
<!-- Legend4 -->
<g id="node17" class="node">
<title>Legend4</title>
<polygon fill="none" stroke="black" points="266.75,-886.58 47.5,-886.58 47.5,-850.58 266.75,-850.58 266.75,-886.58"/>
<text text-anchor="middle" x="157.12" y="-864.7" font-family="Times New Roman,serif" font-size="10.00">Dotted edge: waits via in&#45;flight channel (≤800ms)</text>
</g>
</g>
</svg>
